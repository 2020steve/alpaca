<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
    <title>Alpaca > Forms > Customer Profile > Edit</title>
    <meta name="keywords" content="alpaca,forms,create,gitana"/>
    <meta name="description" content="Customer Profile Form with Custom View Template."/>
    <meta name="author" content="Gitana Software Inc."/>
    <link rel="icon" type="image/x-icon" href="../../../favicon.ico"/>
    <script src="http://maps.google.com/maps/api/js?sensor=false">
    </script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/${jquery.version}/jquery.min.js">
    </script>
    <script type="text/javascript" src="../../js/themeswitchertool.js">
    </script>
    <script type="text/javascript"
            src="http://ajax.googleapis.com/ajax/libs/jqueryui/${jquery.ui.version}/jquery-ui.min.js">
    </script>
    <script type="text/javascript" src="../../../js/alpaca-${project.version}.js">
    </script>
    <script type="text/javascript" src="../../js/example.js">
    </script>
    <link type="text/css"
          href="http://ajax.googleapis.com/ajax/libs/jqueryui/${jquery.ui.version}/themes/base/jquery.ui.all.css"
          rel="stylesheet">
    <link type="text/css" href="../../../css/alpaca-${project.version}.css" rel="stylesheet"/>
    <link type="text/css" href="../../../css/example.css" rel="stylesheet"/>
</head>
<body>
<div class='alpaca-example-container'>
    <div class='alpaca-example-header' id='form-controls' alpaca-types='button'>
        <h2>Alpaca Farm Ice Cream Customer Profile</h2>
    </div>
    <div class='alpaca-example-body'>
        <div class='alpaca-example-case'>
            <h3>Form Button</h3>
            <h4>This example shows how to access buttons, manage buttons and add a new button with custom handlers. This example loads <a href="./data.json" target="_source">data</a>, <a href="./options.json" target="_source">options</a> and
                <a href="./schema.json" target="_source">schema</a> parameters through ajax calls.</h4>
            <div id="field1">
            </div>
            <script type="text/javascript" id="field1-script">
                $(function() {
                    $("#field1").alpaca({
                        "data": "./data.json",
                        "options": "./options.json",
                        "schema": "./schema.json",
                        "postRender": function(renderedField) {
                            var form = renderedField.form;
                            // access all buttons
                            $.each(form.buttons, function(index,button) {
                               if (button.type == 'reloadbutton') {
                                 button.hide();
                               }
                            });
                            // direct reference
                            form.switchViewButton.hide();
                            // try to access control through path
                            var cityControl = renderedField.getControlByPath("address/city");
                            cityControl.setValue("Lexington");
                            form.addButton({
                                "data" : "Custom Button",
                                "postRender" : function(buttonControl) {
                                    buttonControl.field.button({
                                        text: true,
                                        icons: {
                                            primary: "ui-icon-newwin"
                                        }
                                    }).click(function() {
                                        buttonControl.field.removeClass("ui-state-focus ui-state-hover");
                                        var sourceViewDialog = $('<div id="source-alpaca-field" title="View Source"></div>');
                                        var _this = this;
                                        sourceViewDialog.alpaca({
                                            "data": [
                                                {
                                                    "title": "JSON Source",
                                                    "text": JSON.stringify(renderedField.getValue(), null, '&nbsp;')
                                                }
                                            ],
                                            "view": {
                                                "globalTemplate": '<div id="source-view-alpaca-field">{{each data}}<div><h3 style="text-decoration:underline;">${title}</h3><div><pre><code>${text}</pre></code></div></div>{{/each}}</div>'
                                            },
                                            "postRender": function(renderedNewFieldControl) {
                                                sourceViewDialog.dialog({
                                                    resizable: true,
                                                    height: 550,
                                                    width: 650,
                                                    modal: true,
                                                    buttons: {
                                                        "Print": function() {
                                                            var sourceDiv = $('#source-view-alpaca-field', sourceViewDialog);
                                                            if (sourceDiv.printArea) {
                                                                sourceDiv.printArea();
                                                            }
                                                            $(this).dialog("close");
                                                        },
                                                        "Close": function() {
                                                            $(this).dialog("close");
                                                        }
                                                    }
                                                });
                                                $('.ui-dialog').css("overflow", "hidden");
                                                $('.ui-dialog-buttonpane').css("overflow", "hidden");
                                            }
                                        });
                                    });
                                }
                            });
                        }
                    });
                });
            </script>
        </div>
    </div>
    <div class="alpaca-clear"></div>
    <div class="alpaca-example-footer">
        <center class="copyright">
            Copyright &copy; 2011 Gitana Software | All Rights Reserved
        </center>
    </div>
</div>
</body>
</html>
